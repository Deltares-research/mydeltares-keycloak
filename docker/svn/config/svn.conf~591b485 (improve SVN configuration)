LoadModule dav_module modules/mod_dav.so
LoadModule dav_fs_module modules/mod_dav_fs.so

LoadModule dav_svn_module modules/mod_dav_svn.so
LoadModule authz_svn_module modules/mod_authz_svn.so

LoadModule rewrite_module modules/mod_rewrite.so

<IfModule mod_dav_fs.c>
  # Location of the WebDAV lock database.
  DAVLockDB /var/lib/dav/lockdb
</IfModule>

BrowserMatch "Microsoft Data Access Internet Publishing Provider" redirect-carefully
BrowserMatch "MS FrontPage" redirect-carefully
BrowserMatch "^WebDrive" redirect-carefully
BrowserMatch "^WebDAVFS/1.[01234]" redirect-carefully
BrowserMatch "^gnome-vfs/1.0" redirect-carefully
BrowserMatch "^XML Spy" redirect-carefully
BrowserMatch "^Dreamweaver-WebDAV-SCM1" redirect-carefully
BrowserMatch " Konqueror/4" redirect-carefully

BrowserMatch "MSIE [1-4]" nokeepalive ssl-unclean-shutdown downgrade-1.0 force-response-1.0
BrowserMatch "MSIE [5-9]" ssl-unclean-shutdown
BrowserMatch "^SVN" redirect-carefully

LogFormat "%t %u %{SVN-REPOS}e: %{SVN-ACTION}e" subversion

CustomLog logs/subversion.log subversion env=SVN-ACTION
# CustomLog "|/usr/sbin/rotatelogs -t /var/log/apache2/subversion.log 86400" subversion env=SVN-ACTION

RewriteEngine On
RewriteCond %{HTTP:X-Forwarded-Proto} =https
RewriteRule "^/?$" "https://%{HTTP_HOST}/repos/" [L,R=permanent]
RewriteRule "^/?$" "/repos/" [L,R=permanent]

# RewriteRule "^/repos/([^/]+)/(.+)" "/svn/$1/$2" [L,PT,E=svn_repo_redirect:1]
# -or-
#   because of 'SVNListParentPath on'
# RewriteCond expr "! %{REQUEST_URI} =~ m#^/repos/.svnindex.(css|xsl)$#"
# RewriteRule "^/repos/(.+)" "/svn/$1" [L,PT,E=svn_repo_group_redirect:1]

# TODO: Check out the example here : https://httpd.apache.org/docs/2.4/mod/mod_authz_core.html

# Alias / /data/svn/
# Alias /public /public/svn/repos

# Url to valid-user access
<Location /public/repos >

    DAV svn
    DavMinTimeout 300
     # Automatically map any "/repos/delft3d" URL to repository /data/svn/repos/delft3d
    SVNParentPath /data/svn/repos
    # Comment AuthzSVNAccessFile otherwise groups do not get mapped
    AuthzSVNAccessFile /etc/apache2/conf.d/.svn.public.access
    AuthName LDAP_Public_Repos
    AuthType Basic
    AuthBasicProvider directory

    Require valid-user
</Location>

# Url to write access
<Location /repos >
    DAV svn
    DavMinTimeout 300
     # Automatically map any "/repos/delft3d" URL to repository /data/svn/repos/delft3d
    SVNParentPath /data/svn/repos
    # Comment AuthzSVNAccessFile otherwise groups do not get mapped
#     AuthzSVNAccessFile /etc/apache2/conf.d/.svn.admin.access
    AuthName LDAP_Admin_Repos
    AuthType Basic
    AuthBasicProvider directory-admin
    # The limit sections allows any valid user to view the repositories but not update them.
	<Limit GET PROPFIND OPTIONS REPORT>
		require valid-user
	</Limit>
    Require svn_admin
</Location>

<Location /repos/delft3d >
    AuthMerging Or
    Require svn_admin_delft3d
</Location>

<Location /repos/delftfews >
    AuthMerging Or
    Require svn_admin_delftfews
</Location>

<Location /repos/oem >
    AuthMerging Or
    Require svn_admin_oem
</Location>

<Location /repos/oed >
    AuthMerging Or
    Require svn_admin_oed
</Location>

<Location /repos/oet >
    AuthMerging Or
    Require svn_admin_oet
</Location>

<Location /repos/xbeach >
    AuthMerging Or
    Require svn_admin_xbeach
</Location>